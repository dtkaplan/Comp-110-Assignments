# Week 4 Project

## Lang Li

<!-- leave this material as is -->
Compiled on `r date()`.

```{r include = FALSE}
library(DataComputing)
```
<!-- put your content after this line -->

Preparation:
```{r}
data_site = "http://tiny.cc/dcf/2014-Q4-Trips-History-Data-Small.rds"
Trips <- readRDS(gzcon(url(data_site)))
```

1. 
```{r}
ggplot(data = Trips, aes(x = sdate)) + geom_density(adjust=0.4) + labs(title="Trip density plot") + theme(legend.position="right") 
```

2. 
```{r}
Trips <- Trips %>% mutate(time_of_day = lubridate::hour(sdate)+lubridate::minute(sdate)/60)
ggplot(data = Trips, aes(x = time_of_day)) + geom_density(adjust=0.4) + labs(title="Trip density plot") + theme(legend.position="right")
```

3. 
```{r}
Trips <- Trips %>% mutate(day_of_week = lubridate::wday(sdate))
ggplot(data = Trips, aes(x = time_of_day)) + geom_density(adjust=0.4) + labs(title="Trip density plot") + theme(legend.position="right")+facet_wrap(~day_of_week)
```

4. 
```{r}
ggplot(data = Trips, aes(x = time_of_day)) + geom_density(aes(fill = client), alpha = 0.2, color = NA) + labs(title="Trip density plot") + theme(legend.position="right")+facet_wrap(~day_of_week)
```

5. 
```{r}
ggplot(data = Trips, aes(x = time_of_day)) + geom_density(aes(fill = client), alpha = 0.2, color = NA,position=position_stack()) + labs(title="Trip density plot") + theme(legend.position="right")+facet_wrap(~day_of_week)
```

Graph in 4 seems more interesting to me~!!

6. 
```{r}
Trips <- Trips%>% mutate(wday = ifelse (lubridate :: wday(sdate) %in% c(1,7),"weekend","weekday"))
ggplot(data = Trips, aes(x = time_of_day)) + geom_density(aes(fill = client), alpha = 0.2, color = NA) + labs(title="Trip density plot") + theme(legend.position="right")+facet_wrap(~wday)
```

Let's do the vice versa version
```{r}
ggplot(data = Trips, aes(x = time_of_day)) + geom_density(aes(fill = wday), alpha = 0.2, color = NA)+ labs(title="Trip density plot") + theme(legend.position="right")+facet_wrap(~client)
```

I think it is better to do fill of client and facet on facet because it can tell the story better with different behavior happens with different groups of group under certain days. It is clear that during the day in the weekend, maybe visitors may use the bike more as they are generally not registered but things reversed in the weekdays. The second plot shows few information like this.