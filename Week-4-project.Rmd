# Week 4 Project

## Joseph Goodson-Gregg

<!-- leave this material as is -->
Compiled on `r date()`.

```{r include = FALSE}
library(DataComputing)
```
<!-- put your content after this line -->

Here is my content!

Setting up.
```{r cache = TRUE}
data_site <- "http://tiny.cc/dcf/2014-Q4-Trips-History-Data-Small.rds"
Trips <- readRDS(gzcon(url(data_site)))

```

1.
```{r}
ggplot( data = Trips, aes(x = sdate)) + geom_density(adjust=0.4)
  
```

2.
```{r}
Trips %>%
  mutate(time_of_day = lubridate::hour(sdate) + lubridate::minute(sdate) / 60) %>%
  ggplot(aes(x=time_of_day))+geom_density()+aes(colour=client)
```

3.
```{r}
Trips %>%
    mutate(day_of_week = lubridate::wday(sdate)) %>%
    mutate(time_of_day = lubridate::hour(sdate) + lubridate::minute(sdate) / 60) %>%
    ggplot(aes(x=time_of_day))+geom_density()+facet_wrap(~ day_of_week)
```

4.
```{r}
Trips %>%
    mutate(day_of_week = lubridate::wday(sdate)) %>%
    mutate(time_of_day = lubridate::hour(sdate) + lubridate::minute(sdate) / 60) %>%
    ggplot(aes(x=time_of_day))+geom_density(aes(fill=client), color=NA)+facet_wrap(~ day_of_week)
```

5.
```{r}
Trips %>%
    mutate(day_of_week = lubridate::wday(sdate)) %>%
    mutate(time_of_day = lubridate::hour(sdate) + lubridate::minute(sdate) / 60) %>%
    ggplot(aes(x=time_of_day))+geom_density(aes(fill=client), color=NA, position = position_stack())+facet_wrap(~ day_of_week)
```
This graph seems most effective, it tells the difference between casual and registered riders throughout the days, for all the weekdays.

```{r}
Trips %>%
    mutate(wday = ifelse(lubridate::wday(sdate) %in% c(1,7), "weekend", "weekday")) %>%
    mutate(time_of_day = lubridate::hour(sdate) + lubridate::minute(sdate) / 60) %>%
    ggplot(aes(x=time_of_day))+geom_density(aes(fill=wday), color=NA, position = position_stack())+facet_wrap(~ client)
```
Faceted on client, filled on wday

```{r}
Trips %>%
    mutate(wday = ifelse(lubridate::wday(sdate) %in% c(1,7), "weekend", "weekday")) %>%
    mutate(time_of_day = lubridate::hour(sdate) + lubridate::minute(sdate) / 60) %>%
    ggplot(aes(x=time_of_day))+geom_density(aes(fill=client), color=NA, position = position_stack())+facet_wrap(~ wday)
```
Faceted on wday, filled on client


If we want to talk about riding trends within groups throughout the week for casual or for registered riders, faceted on wday, filled on client makes the most sense.

If we want to talk about the differences between casual and registered riders groups during either the week or the weekend, faceted on wday, filled on client makes the most sense.

It depends on the information we want to convey.
