# Week 5 Project

## Phuc Nguyen

<!-- leave this material as is -->
Compiled on `r date()`.

```{r include = FALSE}
library(DataComputing)
```
<!-- put your content after this line -->

# Graph for the Economist

## The data
```{r}
download.file("http://tiny.cc/dcf/ScorecardSmall.Rda", destfile = "ScorecardSmall.Rda")
load("ScorecardSmall.Rda")
```

Make a level of family income at an institution a case
```{r}
Names <- read.csv("http://tiny.cc/dcf/NPT4-names.csv")

Graph_data <- ScorecardSmall %>% 
  filter( ! CCSIZSET %in% c(1,6,7,8)) %>%
  select(-CCSIZSET, -AVGFACSAL, -TUITFTE, -NPT4_PUB, -NPT4_PRIV) %>%
  gather(long_name, cost, -CONTROL, -INSTNM, -ADM_RATE) %>%
  inner_join(Names) %>%
  mutate(short_name = as.character(short_name)) %>%
  mutate(cost = as.numeric(cost)) %>%
  filter(CONTROL !=3 & !short_name %in% c("Q2","Q4") & !is.na(cost) & !is.na(ADM_RATE))
```

```{r}
ggplot(Graph_data, aes(ADM_RATE,cost)) + geom_point(alpha=1/5) + geom_smooth(se=F) + facet_grid(CONTROL~short_name)
```