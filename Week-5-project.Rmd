# Week 5 Project

## Qiuhan Sun

<!-- leave this material as is -->
Compiled on `r date()`.

```{r include = FALSE}
library(DataComputing)
```
<!-- put your content after this line -->


```{r}
download.file("http://tiny.cc/dcf/ScorecardSmall.Rda", destfile ="ScorecardSmall.Rda")
load("ScorecardSmall.Rda")
```

##1
```{r warning=FALSE}
ScoreWide <- ScorecardSmall %>%
  select(CONTROL,ADM_RATE,NPT41_PRIV,NPT43_PRIV,NPT45_PRIV,NPT41_PUB,NPT43_PUB,NPT45_PUB)
```

##2
```{r warning=FALSE}
ScoreNarrow <- ScoreWide %>%
  gather( key=income,
          value=netCost,
          NPT41_PRIV,NPT43_PRIV,NPT45_PRIV,NPT41_PUB,NPT43_PUB,NPT45_PUB) %>%
  mutate(Q = substr(income, 5, 5)) 
```

##3
```{r warning=FALSE}
read.csv("http://tiny.cc/dcf/NPT4-names.csv")
ScoreNarrow %>%
  filter(CONTROL != 3) %>%
  mutate(netCost = netCost/1000) %>%
  ggplot(aes(x = ADM_RATE*100, y = netCost )) +
  geom_point(color = "blue", alpha = .2) + 
  stat_smooth(color = "black") +
  facet_grid( CONTROL ~ Q) +
  ylim(0, 50) +
  xlim(0,100) +
  xlab("Admissions rate,%") +
  ylab("Net cost per year,$'000")
  
```

