# Week 6 Project

## Your name should appear here!

<!-- leave this material as is -->
Compiled on `r date()`.

```{r include = FALSE}
library(DataComputing)
```
<!-- put your content after this line -->

Here is my content!

##Stocks and Dividens 

```{r}
companies <- 
  c("JNJ","PG","MSFT") 
Prices <- read_stock_prices(companies, what = "daily", start_year = 2000, end_year = 2015)
```

## Below my GGPLOT for JNJ, Procter and Gamble and Microsoft 

```{r}
Prices %>%
  ggplot(aes(x = date, y= close)) + geom_line(aes(color = company))
```

## Buy/Sell Profit 

```{r}
Actions <- data.frame(action = c("buy", "sell"), date = ymd(c("2008-01-03", "2012-12-28")))
```

## Below a table for the company, buy and sell 
We use a left join to get the data in the correct format. 

```{r}
Pricesx <- 
  Actions %>%
  left_join(Prices) %>%
  select(action, company, adj_close)%>%
  spread(key = action, value = adj_close)
Pricesx
```

Below, the second table with profits and percentage increases and decreases. 

```{r}
PricesY <-
  Pricesx %>%
  mutate(profit = (sell-buy)) %>%
  mutate(percent = ((sell-buy)/buy)*100) %>%
  select(company, profit, percent)
PricesY
```


##Indexing Prices

The reference date is likely 2005 as indicated by the function. 


```{r}
ref_date <- ymd("2007-01-03")
Reference <- Prices %>%
  filter(date == ref_date) %>%
  select(company, standard = close)

ReferenceY <-
  Prices %>%
  left_join(Reference) %>%
  mutate(Index = (close/standard))
```

```{r}
ReferenceY %>%
  ggplot(aes(x = date, y = Index)) + geom_line(aes(color = company))
```

##Dividends

```{r}
Dividends <- read_stock_prices(companies, what = "dividends") 
DivAndActions <- 
  Dividends %>%
  left_join(Pricesx)
```

##Step2 

```{r}
Amt <-
  DivAndActions %>%
  mutate(DivByStock = dividends * buy)
```

##Step 3 

```{r}
Total <- 
  Amt %>%
  filter(date>ymd("2005-01-03")) %>% 
  filter(date<ymd("2014-12-30")) %>%
  group_by(company) %>%
  summarize(tot_dividend = sum(dividends))
```

## Final Dividends

The total dividend for JNJ is $20.185.
The total dividend for MSFT is $6.260.
The total dividend for PG is $17.986. 
