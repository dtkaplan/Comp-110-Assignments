# Week 6 Project

## Your name should appear here!

<!-- leave this material as is -->
Compiled on `r date()`.

```{r include = FALSE}
library(DataComputing)
library(ggplot2)
```
<!-- put your content after this line -->


##Getting price data
```{r}
companies <- c("AAPL", "YHOO", "GOOG")
Prices <- read_stock_prices(companies, what = "daily", start_year = 2000, end_year = 2015)
```

```{r}
ggplot(data=Prices,aes(x=date,y=close, color = company)) + geom_line() + xlab("Date") + ylab("Daily Closing Share Price (USD)")
```

##Buy/Sell Profit

```{r}
Actions <- data.frame(action = c("buy", "sell"), date = ymd(c("2005-01-03", "2015-02-25")))
```

```{r}
BuySellTab <-
  
  Actions %>% left_join(Prices) %>%
  select(company, action, close) %>%
  spread(key = action, value = close)
  
BuySellTab
```

```{r}
ProfitTab <-
  
  BuySellTab %>% mutate (profit = sell - buy, percent = ((sell-buy)/buy)*100) %>%
  select(company, profit, percent)

ProfitTab
```

##Indexing Prices

```{r}
ref_date <- ymd("2014-01-02")
Reference <-
  
  Prices %>% filter(date == ref_date) %>%
    select(company, standard = close)
```

```{r}
Price_w_ref <-
  Prices %>% left_join(Reference)

```

```{r}
Price_ref_ratio <-
  Price_w_ref %>% mutate(close_standard_ratio = close/standard)

```

```{r}
ggplot(data = Price_ref_ratio ,aes(x = date, y = close_standard_ratio, color = company)) + geom_line() + xlab("Date") + ylab("Index")
```

##Dividends

```{r}
companies <- c("AAPL") #the function below complains when Google, Facebook, Twitter and Yahoo are part of Companies. Maybe they do not pay dividends and therefore there is no data available?
Dividends <- read_stock_prices(companies, what = "dividends")

```

```{r}
Total_divdendTab <- 
    
    Dividends %>% filter(date >= "2005-01-03" & date <= "2015-02-25") %>%
      left_join(Prices, by=c(company = "company", date = "date")) %>%
      select(company, dividends, date, close) %>% 
      mutate(dividend_per_share = dividends*close) %>%
      group_by(company) %>%
      summarize(total_dividend = sum(dividend_per_share))

Total_divdendTab 
```

For Apple, for each stock sold I would have $65.50 in profit, and I would have made $1901.87 in dividends per share. Meaning I had a profit of $1967.37 from January 2005 to February 2015 per share. 