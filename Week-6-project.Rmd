# Week 6 Project

## Qiuhan Sun

<!-- leave this material as is -->
Compiled on `r date()`.

```{r include = FALSE}
library(DataComputing)
```
<!-- put your content after this line -->

#Task
The income (and loss) from buying and selling is higher. The dividend increases gradually, but the maximum dividend does not exceed 10. However, the stock price can increase from 60 to 80 in a very short of time. So the income from selling and buying is higher.

There's no correlation between the income from dividends and from buying and selling. When the price of a stock increases, its dividend does not necessarily increase. Also, some stocks may have higher prices but low dividend.   


# Getting Price Data
```{r warning = FALSE}
companies <- c("AAPL","GOOGL","MSFT")
Prices <- read_stock_prices (companies,what="daily",start_year=2000,end_year=2015)
Prices %>% ggplot(aes(x = date, y = close)) + geom_line(aes (color=company)) 
```


# Buy/Sell Profit
```{r warning = FALSE}
Actions <- data.frame(action=c("buy","sell"),
                      date=ymd(c("2008-01-03","2014-12-30")))
Actions

NewActions <- Actions %>%
  left_join(Prices) %>%
  select(action,company,close) %>%
  spread(key=action,value=close)

NewActions

Profit <- NewActions %>%
 mutate(profit=sell-buy) %>%
 mutate(percent=profit/buy)

Profit
```

## Indexing prices
```{r warning = FALSE}
ref_date <- ymd("2005-01-05")
Reference <- Prices %>% filter (date==ref_date) %>% 
  select(company,standard=close)
NewReference <- Prices %>%
  left_join(Reference) %>%
  mutate (index=close/standard)
```

## Dividends
```{r warning = FALSE}
# google does not pay dividend, so I excluded it out
Dividends <- read_stock_prices(c("AAPL","MSFT"),what="dividends")
Dividendtable <- Dividends %>%
  left_join(NewActions) 

Dividenddollar <- Dividendtable %>%
   mutate(dollar_dividend=dividends*buy) 

TotalDividend <- Dividenddollar %>%
  filter(date>ymd("2008-01-03")) %>% 
  filter(date<ymd("2014-12-30")) %>%
  group_by(company) %>%
  summarize (total_dividend=sum(dollar_dividend))
TotalDividend
```

Compare the dividend to the profit:

Apple (-82.41) and google (-150) made negative profits while MSFT made 11.65 profit. For dividend, google made 0; apple made 836 and microsoft made 182. Dividend seems to be a more stable income source.
